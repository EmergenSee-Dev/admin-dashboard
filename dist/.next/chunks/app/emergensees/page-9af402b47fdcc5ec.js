(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7108],{6087:(e,t,s)=>{Promise.resolve().then(s.bind(s,3119))},3119:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var l=s(5155),a=s(2115),r=s(4919),n=s(2651),i=s(6046),o=s(1521),d=s(143);let c=()=>{var e;let t=(0,i.useRouter)(),s=(0,i.useSearchParams)().get("filter")||"All",[r,c]=(0,a.useState)(s),[m,u]=(0,a.useState)([]),[h,x]=(0,a.useState)(!1),[p,g]=(0,a.useState)(!1),[f,b]=(0,a.useState)(""),v=async()=>{let e="https://backend-api-mxr6.onrender.com/api/emergensee/all";r&&"All"!==r&&(e+="?type=".concat(encodeURIComponent(r)));try{let t=await n.A.get(e);u(t.data.data.reverse())}catch(e){console.error("Error fetching uploads:",e)}};(0,a.useEffect)(()=>{v()},[r]);let j=e=>{c(e),t.push("/emergensees?filter=".concat(encodeURIComponent(e)))},w=async()=>{try{let e=await fetch("https://backend-api-mxr6.onrender.com/api/emergensee/download",{method:"GET",headers:{"Content-Type":"text/csv"}});if(!e.ok)throw Error("Failed to download CSV");let t=await e.blob(),s=window.URL.createObjectURL(t),l=document.createElement("a");l.href=s,l.download="emergensees.csv",document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(s)}catch(e){console.error("Error downloading CSV:",e)}},N=async()=>{window.confirm("WARNING: This will permanently delete all uploads. Are you sure you want to continue?")&&g(!0)},y=async()=>{if("DELETE"!==f.trim().toUpperCase()){alert('Please type "DELETE" to confirm deletion');return}try{for(let e of(x(!0),g(!1),m))if(!(await fetch("https://backend-api-mxr6.onrender.com/api/emergensee/".concat(e._id),{method:"DELETE",headers:{"Content-Type":"application/json"}})).ok)throw Error("Failed to delete upload with ID: ".concat(e._id));await v(),alert("All uploads have been deleted successfully!")}catch(e){console.error("Error deleting uploads:",e),alert("An error occurred while deleting uploads. Please try again.")}finally{x(!1),b("")}};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"p-4 bg-white rounded-xl",children:(0,l.jsx)(d.A,{height:"400px",address:null===(e=m[0])||void 0===e?void 0:e.address})}),(0,l.jsxs)("section",{className:"bg-white rounded-xl p-4 mt-4",children:[(0,l.jsxs)("div",{className:"lg:flex w-full justify-between",children:[(0,l.jsx)("div",{className:"grid lg:grid-cols-6 grid-cols-3 sm:mb-3",children:[{title:"All",value:"All"},{title:"Fall Update",value:"fall"},{title:"Burn Update",value:"burn"},{title:"MVC Update",value:"motor vehicle"},{title:"Assault Update",value:"assault"},{title:"Other Cases",value:"others"}].map((e,t)=>(0,l.jsx)("button",{onClick:()=>j(e.value),className:"lg:p-3 sm:py-3 sm:mb-2 my-auto rounded-full mr-4 lg:text-xs text-[10px] text-[#9FA4A7] lg:px-4 bg-[#EFEFEF]",children:e.title},t))}),(0,l.jsx)("input",{type:"text",placeholder:"Search",className:"bg-[#EFEFEF] p-3 rounded-md lg:w-72 w-full"})]}),m&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"lg:flex justify-between border-b border-[#DFDFDF] py-6",children:[(0,l.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,l.jsx)("p",{className:"uppercase font-bold my-auto",children:"all UPLOADS"}),(0,l.jsxs)("div",{className:"flex gap-3",children:[(0,l.jsx)("button",{onClick:()=>w(),className:"p-3 rounded-full bg-[#FFCC00] hover:bg-[#e6b800] transition-colors whitespace-nowrap",children:"Download CSV"}),(0,l.jsx)("button",{onClick:N,disabled:h||0===m.length,className:"p-3 rounded-full bg-red-500 text-white hover:bg-red-600 transition-colors whitespace-nowrap ".concat(h||0===m.length?"opacity-50 cursor-not-allowed":""),children:h?"Deleting...":"Delete All"})]})]}),(0,l.jsxs)("p",{className:"font-medium",children:[m.length," UPLOADS"]})]}),m.length>0?m.map((e,t)=>(0,l.jsx)(o.A,{data:e},t)):(0,l.jsxs)("p",{className:"text-center py-6",children:["No uploads found for ",(0,l.jsx)("span",{className:"font-bold",children:r}),"."]})]})]}),p&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,l.jsx)("h3",{className:"text-xl font-bold text-red-600 mb-4",children:"Confirm Deletion"}),(0,l.jsxs)("p",{className:"mb-4",children:["This action cannot be undone. This will permanently delete all ",m.length," uploads."]}),(0,l.jsxs)("p",{className:"mb-4 font-medium",children:["Type ",(0,l.jsx)("span",{className:"font-bold",children:"DELETE"})," to confirm:"]}),(0,l.jsx)("input",{type:"text",value:f,onChange:e=>b(e.target.value),className:"w-full p-2 border border-gray-300 rounded mb-4",placeholder:"Type DELETE to confirm",autoFocus:!0}),(0,l.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,l.jsx)("button",{onClick:()=>{g(!1),b("")},className:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300 transition-colors",disabled:h,children:"Cancel"}),(0,l.jsx)("button",{onClick:y,disabled:h||"DELETE"!==f.trim().toUpperCase(),className:"px-4 py-2 text-white rounded transition-colors ".concat(h||"DELETE"!==f.trim().toUpperCase()?"bg-red-300 cursor-not-allowed":"bg-red-600 hover:bg-red-700"),children:h?"Deleting...":"Delete All Permanently"})]})]})})]})},m=()=>(0,l.jsx)(r.default,{children:(0,l.jsx)(a.Suspense,{fallback:(0,l.jsx)("div",{children:"Loading..."}),children:(0,l.jsx)(c,{})})})},337:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var l=s(5155);s(2115);let a=e=>{let{type:t}=e;return(0,l.jsx)("div",{children:(0,l.jsxs)("button",{className:"p-2 rounded-full capitalize text-white ml-4 text-sm ".concat("fall"===t?"bg-[#1AA029]":"assault"===t?"bg-[#F57E43]":"burn"===t?"bg-[#A01A1A]":"motor vehicle"===t?"bg-[#2764E7]":"others"===t?"bg-[#671C73]":""),children:[t," Update"]})})}},1521:(e,t,s)=>{"use strict";s.d(t,{A:()=>o});var l=s(5155),a=s(8931),r=s(8173),n=s.n(r);s(2115);var i=s(337);let o=e=>{var t;let{data:s}=e,r=async()=>{if(window.confirm("Are you sure you want to delete this record?"))try{if(!(await fetch("https://backend-api-mxr6.onrender.com/api/emergensee/".concat(null==s?void 0:s._id),{method:"DELETE",headers:{"Content-Type":"application/json"}})).ok)throw Error("Failed to delete Emergensee record.");alert("Emergensee deleted successfully!"),window.location.reload()}catch(e){console.error("Error deleting Emergensee:",e),alert("Error deleting Emergensee. Please try again.")}};return(0,l.jsxs)("div",{className:"border-b border-[#DFDFDF] py-2 lg:flex justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex sm:justify-between",children:[(0,l.jsx)("p",{className:"font-medium my-auto text-lg capitalize text-[#3D5059]",children:null==s?void 0:s.name}),(0,l.jsx)(i.A,{type:null==s?void 0:s.type})]}),(0,l.jsxs)("div",{className:"flex text-[#9FA4A7] ",children:[(0,l.jsx)("p",{children:null==s?void 0:null===(t=s.author)||void 0===t?void 0:t.name}),(0,l.jsx)("p",{className:"font-medium ml-2",children:(0,a.Y)(new Date(null==s?void 0:s.createdAt))})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(n(),{href:"/emergensees/single?id=".concat(null==s?void 0:s._id),children:(0,l.jsx)("button",{className:"bg-[#66B5FF33] text-[#3688FF] sm:mt-3 p-2 px-6 my-auto",children:"View upload"})}),(0,l.jsx)("button",{className:"p-3 my-auto",onClick:()=>r(),children:(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-trash-fill",viewBox:"0 0 16 16",children:(0,l.jsx)("path",{d:"M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5M8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5m3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0"})})})]})]})}},4919:(e,t,s)=>{"use strict";s.d(t,{default:()=>u});var l=s(5155),a=s(2115),r=s(8173),n=s.n(r),i=s(6046);let o=()=>{let e=e=>{if((0,i.usePathname)()===e)return!0};return(0,l.jsxs)("div",{className:"h-screen",children:[(0,l.jsx)(n(),{href:"/dashboard",children:(0,l.jsx)("div",{className:"my-6 ".concat(e("/dashboard")&&"bg-[#FFCC00] p-3 rounded-xl"),children:(0,l.jsx)("p",{className:"uppercase text-[#3D5059] font-bold",children:"Dashboard"})})}),[{title:"users",link:"/users"},{title:"emergensees",link:"/emergensees"},{title:"logout",link:"/"}].map(t=>(0,l.jsx)(n(),{href:t.link,children:(0,l.jsxs)("div",{className:"flex my-5 px-3 ".concat(e(t.link)?"bg-[#FFCC00] p-3 rounded-xl":""),children:[(0,l.jsx)("img",{className:"mr-3 w-4 h-4 my-auto",src:"/images/icons/".concat(t.title,".svg"),alt:""}),(0,l.jsx)("p",{className:"capitalize font-medium",children:t.title})]})},t.title))]})},d=e=>{let{open:t,handleClose:s}=e;return t&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{onClick:()=>s(),className:"bg-[#2B2B2B57] cursor-pointer fixed top-16 backdrop-blur-sm w-screen h-screen"}),(0,l.jsxs)("div",{className:"absolute lg:w-[30%] w-[90%] top-20 right-4 bg-white p-4 rounded-xl",children:[(0,l.jsxs)("div",{className:"flex  justify-between mb-1",children:[(0,l.jsx)("p",{className:"text-[#9FA4A7] text-sm",children:"Notifications"}),(0,l.jsx)("p",{className:"text-[#3688FF] text-sm",children:"See all"})]}),[1,2,3].map(e=>(0,l.jsx)("div",{className:"py-3 border-b border-[#ABB3B7]",children:(0,l.jsxs)("div",{className:"bg-[#D7D7D833] rounded-md p-2 flex",children:[(0,l.jsx)("img",{className:"my-auto",src:"/images/scheduler.png",alt:""}),(0,l.jsxs)("div",{className:"ml-3",children:[(0,l.jsx)("p",{className:"text-[#0E4BF1] font-medium text-sm",children:"New Emergency"}),(0,l.jsx)("p",{className:"text-xs",children:"Burn incident at Lekki"}),(0,l.jsx)("p",{className:"text-xs",children:"Tuesday, June 14, 2024 18:16:1"})]})]})}))]})]})};var c=s(4928),m=s(8400);let u=e=>{let{children:t}=e,[s,r]=(0,a.useState)(!1),n=(0,i.useRouter)(),[u,h]=(0,a.useState)(!1),[x,p]=(0,c.useAtom)(m.S);return(0,a.useEffect)(()=>{let e=setTimeout(()=>{x||n.replace("/")},1e3);return()=>clearTimeout(e)},[x,n]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("header",{className:"p-3 flex items-center fixed top-0 w-full bg-white shadow-md z-50",children:[(0,l.jsx)("img",{src:"/images/emergensee4.png",className:"h-10 object-cover",alt:"Logo"}),(0,l.jsxs)("div",{className:"ml-auto flex items-center gap-4",children:[(0,l.jsx)("img",{className:"w-10 h-10 cursor-pointer md:hidden",onClick:()=>h(!u),src:"/images/menu.svg",alt:"Menu"}),(0,l.jsx)("img",{className:"w-10 h-10 cursor-pointer",onClick:()=>r(!s),src:"/images/notification.png",alt:"Notifications"})]})]}),(0,l.jsxs)("div",{className:"flex flex-col md:flex-row p-3 mt-16",children:[(0,l.jsx)("div",{className:"fixed p-4 left-0 lg:w-[23%] bg-white shadow-lg transform transition-transform duration-300 ease-in-out\n            ".concat(u?"translate-x-0":"-translate-x-full"," md:translate-x-0 md:static"),children:(0,l.jsx)(o,{})}),(0,l.jsx)("div",{className:"w-full lg:px-3",children:t})]}),(0,l.jsx)(d,{open:s,handleClose:()=>r(!1)})]})}},143:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var l=s(5155);let a=e=>{let{address:t,height:s}=e,a=encodeURIComponent(t);return(0,l.jsxs)("div",{className:"",style:{textDecoration:"none",overflow:"hidden",maxWidth:"100%",height:s},children:[(0,l.jsx)("div",{id:"google-maps-display",style:{height:"100%",width:"100%",maxWidth:"100%"},children:(0,l.jsx)("iframe",{style:{height:"100%",width:"100%",border:"0"},frameBorder:"0",src:"https://www.google.com/maps/embed/v1/place?q=".concat(a,"&key=AIzaSyBFw0Qbyq9zTFTd-tUY6dZWTgaQzuU17R8"),allowFullScreen:!0})}),(0,l.jsx)("a",{className:"googlemaps-made",href:"https://www.bootstrapskins.com/themes",id:"auth-map-data"})]})}},8400:(e,t,s)=>{"use strict";s.d(t,{S:()=>r});var l=s(1094);let a=localStorage,r=(0,l.tG)("token",null,{getItem:e=>{var t;return null!==(t=null==a?void 0:a.getItem(e))&&void 0!==t?t:null},setItem:(e,t)=>null==a?void 0:a.setItem(e,t),removeItem:e=>null==a?void 0:a.removeItem(e)})},8931:(e,t,s)=>{"use strict";s.d(t,{Y:()=>l,f:()=>a});let l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY MMMM DD",s=new Date(e);if(isNaN(s.getTime()))return"Invalid Date";let l=e=>e.toString().padStart(2,"0"),a={YYYY:s.getFullYear().toString(),MMMM:["January","February","March","April","May","June","July","August","September","October","November","December"][s.getMonth()],MM:l(s.getMonth()+1),DD:l(s.getDate()),HH:l(s.getHours()),mm:l(s.getMinutes()),ss:l(s.getSeconds())};return t.replace(/YYYY|MMMM|MM|DD|HH|mm|ss/g,e=>a[e])},a=e=>{if(!e)return"";let t=new Date(e);return isNaN(t.getTime())?e:t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0})}}},e=>{var t=t=>e(e.s=t);e.O(0,[4928,6023,8173,2651,8441,1517,7358],()=>t(6087)),_N_E=e.O()}]);